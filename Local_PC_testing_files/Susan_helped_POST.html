<!-- This file is used to test the .post() function as a local file
The target is http://ec2-52-24-231-219.us-west-2.compute.amazonaws.com/ajaxll.php.
It works very well.
This line in remote PHP file is required to allow post access in Amazon Web Services:
header("Access-Control-Allow-Origin: *");

Susan Liu (LIU Zhonghong) helped to figure out.
-- Duan Liu, 2016-Feb
-->
<html>
<head>
<title>POST Testing</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
</head>

<body>
<h1>Post Testing</h1>

<button class="btn btn-large btn-primary">Alert</button>

<button id="BMDS_run_diverge_3" class="btn btn-large btn-primary">Test Run BMDS 3</button>
<div id="show_content"></div>
<div id='ct'>..i</div>

<div id='icon_here'>..icon here.</div>
==============================================<br>
<pre>
The input object looks like this:


{
    "options": {
        "bmds_version": "2.60", 
        "generate_emf": true,  
    },
    "runs": [
		{"id":31, "model_app_name": "logist",
			"dfile":"LogLogistic .....},
		{"id":32, "model_app_name": "gamma",
			"dfile":"Gamma ....},
		....
		]
}        

====================================
The output object looks like this:


{
    "options": {
        "bmds_version": "2.60", 
        "generate_emf": true,  
    },
    "runs": [
		{"id":31, "model_app_name": "logist",
			"OUT_file_str":"LogLogistic ..... ",
			"base64_emf_str": " ...... "},		   // If generate_emf is true.

		{"id":32, "model_app_name": "gamma",
			"OUT_file_str":"Gamma ..... ",
			"base64_emf_str": " ...... "},		   // If generate_emf is true.
		....
		]
}        
        
	</pre>




</body>
</html>

<script type='text/javascript'>
$(document).ready(function(){


// using these values, or “2.60" for example, so that a user can specify which version of BMDS to use (and they can re-run older versions for legacy support)

// if "generate_emf": false, don’t create EMF image, return "emf: null” in the output
var submittion_str = {
    "options": {
        "bmds_version": "2.60", 
        "generate_emf": false,  
    },
    "runs": 


[{"id":31, "model_app_name":"logist",
	"dfile":"LogLogistic\nBMDS_Model_Run\nLogLogistic.(D)\nLogLogistic.out\n5\n250 1e-08 1e-08 0 1 1 1 0 0\n0.1 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Incidence NEGATIVE_RESPONSE\n0.000000 0 20\n50.000000 0 20\n150.000000 3 17\n250.000000 6 14\n350.000000 6 14\n"
	},
	{"id":32, "model_app_name":"multistage",
	"dfile":"Multistage\nBMDS MODEL RUN\nMultistage_test.(D) \nMultistage_test.OUT \n4 \n2 \n 250 2.22045e-16 1.49012e-8 1 1 0 1 1\n0.10 0 0.95\n-9999 -9999 -9999 ...\n0\n-9999 -9999 -9999 ...\nDose Resp NEGATIVE_RESPONSE\n0 3 47\n50 6 44\n100 10 40\n150 19 31\n"
	},
    {"id":33, "model_app_name":"exponential",
	"dfile":"Exponential\nDefault settings but downward adversity\nExponential_test.(D)\nExponential_test.OUT\n1 5 -1 1111 14 0 1\n500 1.00E-08 1.00E-08 0 1 1 0\n0.10 0 0.95\n-9999 -9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999 -9999\nDOSE N MEAN STD\n0 20 6 1.2\n25 20 5.2 1.1\n50 19 2.4 0.81\n100 20 1.1 0.74\n200 20 0.75 0.66\n"
	},
    {"id":34, "model_app_name":"gamma",
	"dfile":"Gamma\nBMDS MODEL RUN\nGamma_test.(D)\nGamma_test.OUT\n4\n250 2.22045e-16 1.49012e-8 1 1 1 1 0\n0.10 0 0.95\n-9999 -9999 -9999 ...\n0\n-9999 -9999 -9999 ...\nDose Resp NEGATIVE_RESPONSE\n0 3 47\n50 6 44\n100 10 40\n150 19 31\n"
	},
    {"id":35, "model_app_name":"hill",
	"dfile":"Hill\nBMDS Model Run\nHill.(D)\nHill.OUT\n1 4 0\n500 0.00000001 0.00000001 0 1 1 0 0\n2 0.05 0 0.95\n-9999 -9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999 -9999\nDose N MeanBW SDBW\n0 37 43.85 2.69\n0.1 35 43.51 2.86\n0.5 43 40.04 3\n1.1 42 35.09 2.56\n"
	},
    {"id":36, "model_app_name":"ms_combo",
	"dfile":"MS_Combo\nBMDS_Model_Run\nMS_Combo.(D)\n3\n5 2 Dichotomous.dax\n500 1.00E-08 1.00E-08 0 1 1 0 0\n0.01 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Effect NEGATIVE_RESPONSE\n0 0 100\n50 5 95\n100 30 70\n150 65 35\n200 90 10\n5 2 Dichotomous.dax\n500 1.00E-08 1.00E-08 0 1 1 0 0\n0.01 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Effect2 NEGATIVE_RESPONSE\n0 5 95\n50 10 90\n100 33 67\n150 67 33\n200 93 7\n5 2 Dichotomous.dax\n500 1.00E-08 1.00E-08 0 1 1 0 0\n0.01 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Effect3 NEGATIVE_RESPONSE\n0 1 99\n50 68 32\n100 78 22\n150 88 12\n200 98 2\n"
	},
    {"id":37, "model_app_name":"nctr",
	"dfile":"NCTR\nBMDS MODEL RUN\nNCTR.(D)\nNCTR.out\n39 4\n500 1.00E-08 1.00E-08 0 1 1 0 0 0\n0.1000 0 0.95 1000 0\n-9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999\nDose Resp Negative_Resp Covariate Column 5\n0 1 15 16 -9999\n0 1 8 9 -9999\n0 2 13 15 -9999\n0 3 11 14 -9999\n0 3 10 13 -9999\n0 0 9 9 -9999\n0 2 8 10 -9999\n0 2 12 14 -9999\n0 1 9 10 -9999\n0 2 9 11 -9999\n25 4 10 14 -9999\n25 5 4 9 -9999\n25 6 8 14 -9999\n25 2 7 9 -9999\n25 6 7 13 -9999\n25 3 9 12 -9999\n25 1 9 10 -9999\n25 2 8 10 -9999\n25 4 7 11 -9999\n25 3 11 14 -9999\n50 4 7 11 -9999\n50 5 6 11 -9999\n50 5 9 14 -9999\n50 4 7 11 -9999\n50 5 5 10 -9999\n50 4 7 11 -9999\n50 5 5 10 -9999\n50 6 9 15 -9999\n50 2 5 7 -9999\n50 4 10 14 -9999\n100 6 5 11 -9999\n100 6 8 14 -9999\n100 8 4 12 -9999\n100 7 6 13 -9999\n100 8 4 12 -9999\n100 6 8 14 -9999\n100 6 5 11 -9999\n100 5 3 8 -9999\n100 4 6 10 -9999\n"
	},
    {"id":38, "model_app_name":"nlogistic",
	"dfile":"Nlogistic\nBMDS MODEL RUN\nNlogistic.(D)\nNlogistic.OUT\n39 4\n500 1.00E-08 1.00E-08 1 0 1 1 0 0\n0.1000 0 0.95 1000 0\n-9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999\nDose Resp Negative_Response Covariate Column 5\n0 1 15 16 -9999\n0 1 8 9 -9999\n0 2 13 15 -9999\n0 3 11 14 -9999\n0 3 10 13 -9999\n0 0 9 9 -9999\n0 2 8 10 -9999\n0 2 12 14 -9999\n0 1 9 10 -9999\n0 2 9 11 -9999\n25 4 10 14 -9999\n25 5 4 9 -9999\n25 6 8 14 -9999\n25 2 7 9 -9999\n25 6 7 13 -9999\n25 3 9 12 -9999\n25 1 9 10 -9999\n25 2 8 10 -9999\n25 4 7 11 -9999\n25 3 11 14 -9999\n50 4 7 11 -9999\n50 5 6 11 -9999\n50 5 9 14 -9999\n50 4 7 11 -9999\n50 5 5 10 -9999\n50 4 7 11 -9999\n50 5 5 10 -9999\n50 6 9 15 -9999\n50 2 5 7 -9999\n50 4 10 14 -9999\n100 6 5 11 -9999\n100 6 8 14 -9999\n100 8 4 12 -9999\n100 7 6 13 -9999\n100 8 4 12 -9999\n100 6 8 14 -9999\n100 6 5 11 -9999\n100 5 3 8 -9999\n100 4 6 10 -9999\n"
	},
    {"id":39, "model_app_name":"logist",
	"dfile":"LogLogistic\nBMDS_Model_Run\ntest\noutput.out\n5\n250 1e-08 1e-08 0 1 1 1 0 0\n0.1 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Incidence NEGATIVE_RESPONSE\n0.000000 0 20\n50.000000 0 20\n150.000000 3 17\n250.000000 6 14\n350.000000 6 14\n"
	},
    {"id":40, "model_app_name":"power",
	"dfile":"Power\nBMDS Model Run\nPower.(D)\nPoser.OUT\n1 4 0\n500 0.00000001 0.00000001 0 1 1 0 0\n2 0.05 0 0.95\n-9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999\nDose N MeanBW SDBW\n0 37 43.85 2.69\n0.1 35 43.51 2.86\n0.5 43 40.04 3\n1.1 42 35.09 2.56\n"
	},
    {"id":41, "model_app_name":"poly",
	"dfile":"Polynomial\nBMDS Model Run\nPoly.(D)\nPoly.OUT\n3\n1 4 0\n500 0.00000001 0.00000001 0 -1 1 0 0\n2 0.05 0 0.95\n-9999 -9999 -9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999 -9999\nDose N MeanBW SDBW\n0 37 43.85 2.69\n0.1 35 43.51 2.86\n0.5 43 40.04 3\n1.1 42 35.09 2.56\n"
	},
    {"id":42, "model_app_name":"probit",
	"dfile":"Probit\nBMDS MODEL RUN\nProbit.(D)\nProbit.OUT\n4\n250 2.22045e-16 1.49012e-8 1 0 0 1 1 0\n0.10 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Resp NEGATIVE_RESPONSE\n0 3 47\n50 6 44\n100 10 40\n150 19 31\n"
	},
    {"id":43, "model_app_name":"raivr",
	"dfile":"Rai_and_Van_Ryzin\nBMDS MODEL RUN\nRaiVR.(D)\nRaiVR.OUT\n39 4\n500 1.00E-08 1.00E-08 0 1 1 0 0 0\n0.1000 0 0.95 1000 0\n-9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999\n0\n-9999 -9999 -9999 -9999 -9999\n-9999 -9999 -9999 -9999\nDose Resp Negative_Resp Covariate Dose_Group\n0 1 15 16 -9999\n0 1 8 9 -9999\n0 2 13 15 -9999\n0 3 11 14 -9999\n0 3 10 13 -9999\n0 0 9 9 -9999\n0 2 8 10 -9999\n0 2 12 14 -9999\n0 1 9 10 -9999\n0 2 9 11 -9999\n25 4 10 14 -9999\n25 5 4 9 -9999\n25 6 8 14 -9999\n25 2 7 9 -9999\n25 6 7 13 -9999\n25 3 9 12 -9999\n25 1 9 10 -9999\n25 2 8 10 -9999\n25 4 7 11 -9999\n25 3 11 14 -9999\n50 4 7 11 -9999\n50 5 6 11 -9999\n50 5 9 14 -9999\n50 4 7 11 -9999\n50 5 5 10 -9999\n50 4 7 11 -9999\n50 5 5 10 -9999\n50 6 9 15 -9999\n50 2 5 7 -9999\n50 4 10 14 -9999\n100 6 5 11 -9999\n100 6 8 14 -9999\n100 8 4 12 -9999\n100 7 6 13 -9999\n100 8 4 12 -9999\n100 6 8 14 -9999\n100 6 5 11 -9999\n100 5 3 8 -9999\n100 4 6 10 -9999\n"
	},
    {"id":44, "model_app_name":"probit",
	"dfile":"Probit\nBMDS MODEL RUN\nProbit.(D)\nProbit.OUT\n4\n250 2.22045e-16 1.49012e-8 1 0 0 1 1 0\n0.10 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Resp NEGATIVE_RESPONSE\n0 3 47\n50 6 44\n100 10 40\n150 19 31\n"
	},
    {"id":45, "model_app_name":"weibull",
	"dfile":"Weibull\nReal Weibull\nWeibull-Di.(D)\nWeibull-Di.OUT\n4\n250 2.22045e-16 1.49012e-8 1 1 1 1 0\n0.10 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Resp NEGATIVE_RESPONSE\n0 3 47\n50 6 44\n100 10 40\n150 19 31\n"
	},
    {"id":46, "model_app_name":"weibull_bg_response",
	"dfile":"Weibull_bg_response\nBMDS_MODEL_RUN\nWeibull_bg_dose.(D)\nWeibull_bg_dose.OUT\n5\n500 1.00E-08 1.00E-08 0 1 1 0 0\n0.1000 0 0.95\n-9999 -9999 -9999\n0\n-9999 -9999 -9999\nDose Effect NEGATIVE_RESPONSE\n0 0 100\n50 5 95\n100 30 70\n150 65 35\n200 90 10\n"
	},
    {"id":47, "model_app_name":"weibull",
	"dfile":"Weibull\nQuantal Linear\nWeibull.(D)\nWeibull.OUT\n4\n250 2.22045e-16 1.49012e-8 1 1 1 1 0\n0.10 0 0.95\n-9999 -9999 1\n0\n-9999 -9999 -9999\nDose Resp NEGATIVE_RESPONSE\n0 3 47\n50 6 44\n100 10 40\n150 19 31\n"
	}
]
}


$("#BMDS_run_diverge_3").click(function(e){
	seconds_elapse();
	$.ajax({url: "http://ec2-52-24-231-219.us-west-2.compute.amazonaws.com/BMDS_execution.php", 
		data: {data: JSON.stringify(submittion_str)},
		// data: 'application/x-www-form-urlencoded; charset=UTF-8', //submittion, 		// Data to send.
		contentType: "text/plain",
		method: "POST",
		// dataType: "application/json",	// The data type to receive. datatype : "application/json",
		cache: false, // The browser not to store content
 		
    	
		success: function(data){
			clearTimeout(seconds_100);
			$("#show_content").html("Received data: <br>.." + data + ".. <br>..");
			
			var obj = JSON.parse(data);
			
			$("#show_content").html('json conversion works. <br><br><br>' + data + '<br>' + 
				obj[0].model_app_name);
			$("#show_content").html('json conversion works 2. <br><br><br>' + data + '<br>"<pre>"' + 
				obj[4].OUT_file_str);
			// var id_content_arr = obj.models[0].id_content.
			
			// $("#show_content").html('Great, obj.models.toString(): <br>' + id_content_arr);
			$("#show_content").html('Great, Values extracted from returned jSon string: ' +
				// "<br> This should work: "+ Object.getOwnPropertyNames(obj.models[0].id_content(0)) ); //+
				"<br>Results for one of the models<br><br>" + 
				"id: " + obj[4].id.toString() +"<br>" +
				"Model name: " + obj[4].model_app_name.toString() +"<br>" +
				"<br>Result file: <pre>" + obj[4].OUT_file_str.toString() +"<pre>" +
				"<br>Base64 decoded .emf file: <br>" + 
				// "<img src = '" + 
				obj[4].base64_emf_str.toString() +
				// atob(obj[4].base64_emf_str) +
				// atob(obj[4].base64_emf_str.toString()) +
				"'>");		// atob() for decoding base64.
			// document.getElementById('show_content') = 'Hello';// atob(obj[4].base64_emf_str);
			// document.getElementById('show_content').src = atob(obj[4].base64_emf_str.toString());
			document.getElementById('ct').setAttribute('src', data);//obj[4].base64_emf_str);
			    var icon_elem = document.getElementById("icon_here");
    icon_elem.src = data;
			alert("here.");
			// var data = 'data:image/emf;base64,'+ obj[4].base64_emf_str;
			var icon_elem = document.getElementById("ct");
			//icon_elem.src = data;
			icon_elem.src = data;
    	}
	});
})

}
)

</script>


<script type="text/javascript">



var data = 'data:image/gif;base64,'+
    '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'+
    'Tata18rWtrr1rTIIAQA7';


    var icon_elem = document.getElementById("icon_here");
    icon_elem.src = data;
















var i = 0;
var seconds_100;

function seconds_elapse(){
	$("#show_content").html("<br>This process usually takes about 10 seconds. The start ime is: <br><br>" + 
		"Time: <font size='6' color='blue' face='verdana'><b> &nbsp&nbsp" + i + "&nbsp&nbsp</font></b>   Seconds.");
	i = i + 1;
	if (i > 100){
		$("#show_content").html("Error, please try to reload, or report the problem.");
	}
	seconds_100 = setTimeout("display_time()",1000);
}

function display_time() {
	seconds_elapse()
}
</script>















